const web3=new Web3(Web3.givenProvider||"http://127.0.0.1:7545");var currentAcc=void 0,isConnected=!1;function showIndicator(){$("#indicator").show()}function hideIndicator(){$("#indicator").hide(),setMess("")}function showMessage(e,n){n=null==n?"default":n;window.notyf.open({type:n,message:e,duration:"5000",ripple:!0,dismissible:!0,position:{x:"right",y:"top"}})}function PostToServer(e,n,t){$.ajax({url:e,data:n,method:"POST",dataType:"json",traditional:!0,contentType:"application/json; charset=utf-8"}).done((function(e){t(e),hideIndicator()})).fail((function(){hideIndicator()}))}function setting(){$("#wallet-connect-metamask").click((function(){showIndicator(),connectmetamask()})),$("#logout").click((function(){disconnectState()}))}$(document).ready((function(){setting()}));var isregisterEvent=!1,iden="hexanftiden";async function init(){if(showIndicator(),null==web3.givenProvider)isConnected=!1,hideIndicator();else{var e=localStorage.getItem(iden);null==e||""==e||null==e?hideIndicator():await connectmetamask()}}function registerevent(){isregisterEvent||(isregisterEvent=!0,window.ethereum.on("accountsChanged",(async function(e){showIndicator(),e.length>=1?await changeAcc(e[0]):(isConnected=!1,hideIndicator(),disconnectState())})),window.ethereum.on("chainChanged",(async function(e){await checknw(),hideIndicator()})))}async function connectmetamask(){if(null==web3.givenProvider)isConnected=!1,showMessage("No provider was found","danger"),hideIndicator();else try{var e=await web3.eth.requestAccounts();e.length>=1?(changeAcc(currentAcc=e[0]),$("#connectWallet").modal("hide"),registerevent()):(isConnected=!1,hideIndicator())}catch{isConnected=!1,hideIndicator()}}async function changeAcc(e){isConnected=!0,currentAcc=e,await checknw(),localStorage.setItem(iden,e),$("#user-nav").text(e),connectState(),"undefined"!=typeof onAccChanged&&onAccChanged()}function connectState(){$("#signinbtn").hide(),$("#nav-profile").show(500)}function disconnectState(){$("#signinbtn").show(),$("#nav-profile").hide(),currentAcc=void 0,localStorage.setItem(iden,"")}function getCurrentWeb3(){return web3}function getAcc(){return currentAcc}async function checkConnect(){if(isConnected||await init(),isConnected)return isConnected}async function switchEthereumChain(){try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x38"}]})}catch(e){if(4902===e.code)try{await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:"0x38",chainName:"Binance Smart Chain",nativeCurrency:{name:"Binance",symbol:"BNB",decimals:18},blockExplorerUrls:["https://bscscan.com/"],rpcUrls:["https://bsc-dataseed1.ninicoin.io"]}]})}catch(e){}}}async function checknw(){if("0x38"!=web3.currentProvider.chainId){showMessage("Please change to BSC Mainet","warning");try{await switchEthereumChain()}catch{}}}function setMess(e){$("#preloader-mess").text(e)}function getData(e){return $.ajax({url:e,type:"GET"})}